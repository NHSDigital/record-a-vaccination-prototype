{% extends 'layout.html' %}

{% block pageTitle %}
  East of England
{% endblock %}

{% block header %}
  {% include "user-admin/v4/_header.html" %}
{% endblock %}

{% set organisation = {name: data.nhsTrusts[data.organisationCode]} %}

{% block outerContent %}
  {{ backLink({
    href: "/user-admin/v4/add-user",
    text: "Back",
    classes: "nhsuk-u-margin-top-4"
  }) }}
{% endblock %}

{% block content %}
  <div class="nhsuk-grid-row">
    <div class="nhsuk-grid-column-two-thirds">

      <h1 class="nhsuk-heading-xl">Check and {% if existingUserWithSameEmail %}reactivate{% else %}add{% endif %} user</h1>

      {{ summaryList({
        rows: [
          {
            key: {
              text: "Name"
            },
            value: {
              text: data.firstName + " " + data.lastName
            },
            actions: {
              items: [
                {
                  href: "/user-admin/v4/add-user",
                  text: "Change",
                  visuallyHiddenText: "name"
                }
              ]
            }
          },
          {
            key: {
              text: "Email address"
            },
            value: {
              html: data["email"]
            },
            actions: {
              items: [
                {
                  href: "/user-admin/v4/add-user",
                  text: "Change",
                  visuallyHiddenText: "email address"
                }
              ]
            }
          },
          {
            key: {
              text: "Clinical"
            },
            value: {
              html: (data["clinician"] | capitalize)
            },
            actions: {
              items: [
                {
                  href: "/user-admin/v4/add-user",
                  text: "Change",
                  visuallyHiddenText: "clinical role"
                }
              ]
            }
          },
          {
            key: {
              text: "Permission level"
            },
            value: {
              html: data["role"]
            },
            actions: {
              items: [
                {
                  href: "/user-admin/v4/add-user",
                  text: "Change",
                  visuallyHiddenText: "role"
                }
              ]
            }
          }
        ]
      }) }}


      {% if existingUserWithSameEmail %}
        <p>{{ data.firstName }} will be re-activated and sent this email:</p>
      {% else %}
        <p>{{ data.firstName }} will be sent this welcome email with information about activating an account:</p>
      {% endif %}

      <div class="app-email-preview">
        {% if existingUserWithSameEmail %}
          {% include "user-admin/v4/_reactivation-email.html" %}
        {% else %}
          {% include "user-admin/v4/_welcome-email.html" %}
        {% endif %}
      </div>


      <form action="/user-admin/v4/add" method="post">
        {{ button({
          "text": "Confirm and send"
        }) }}
      </form>


    </div>
  </div>
{% endblock %}
